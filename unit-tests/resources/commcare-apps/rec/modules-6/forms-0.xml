<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">
	<h:head>
		<h:title>Daily Statistics</h:title>
		<model>
			<instance>
				<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/23735CEF-8A16-45CA-B185-A3F6263A7BBE" uiVersion="1" version="4" name="Daily Statistics">
					<stat_disclaimer>
						<lbl_n_consults_today/>
						<disclaimer_exit/>
					</stat_disclaimer>
					<n_consults_today/>
					<tdy/>
				<orx:meta xmlns:cc="http://commcarehq.org/xforms"><orx:deviceID/><orx:timeStart/><orx:timeEnd/><orx:username/><orx:userID/><orx:instanceID/><cc:appVersion/></orx:meta></data>
			</instance><instance id="commcaresession" src="jr://instance/session"/>
			<instance id="casedb" src="jr://instance/casedb"/>
			<bind nodeset="/data/stat_disclaimer"/>
			<bind nodeset="/data/stat_disclaimer/lbl_n_consults_today"/>
			<bind nodeset="/data/stat_disclaimer/disclaimer_exit" constraint="1=2" jr:constraintMsg="jr:itext('stat_disclaimer/disclaimer_exit-constraintMsg')" required="true()"/>
			<bind nodeset="/data/n_consults_today" calculate="count(instance('casedb')/casedb/case[@case_type='imci_visit'][date(visit_date) = /data/tdy])"/>
			<bind nodeset="/data/tdy" calculate="today()"/>
			<itext>
				<translation lang="en" default="">
					<text id="stat_disclaimer-label">
						<value>Today's Statistics</value>
					</text>
					<text id="stat_disclaimer/lbl_n_consults_today-label">
						<value>Number of consultations for today (<output value="/data/tdy"/>): <output value="/data/n_consults_today"/></value>
					</text>
					<text id="stat_disclaimer/disclaimer_exit-constraintMsg">
						<value>Please exit the form after inspecting the statistics</value>
					</text>
				</translation>
				<translation lang="fra">
					<text id="stat_disclaimer-label">
						<value>Statistiques journali&#232;res</value>
					</text>
					<text id="stat_disclaimer/lbl_n_consults_today-label">
						<value>Nombre de consultations de la journ&#233;e (<output value="/data/tdy"/>) : <output value="/data/n_consults_today"/></value>
					</text>
					<text id="stat_disclaimer/disclaimer_exit-constraintMsg">
						<value>Veuillez quitter le formulaire apr&#232;s avoir consult&#233; les statistiques</value>
					</text>
				</translation>
			</itext>
		<setvalue event="xforms-ready" ref="/data/meta/deviceID" value="instance('commcaresession')/session/context/deviceid"/><setvalue event="xforms-ready" ref="/data/meta/timeStart" value="now()"/><bind nodeset="/data/meta/timeStart" type="xsd:dateTime"/><setvalue event="xforms-revalidate" ref="/data/meta/timeEnd" value="now()"/><bind nodeset="/data/meta/timeEnd" type="xsd:dateTime"/><setvalue event="xforms-ready" ref="/data/meta/username" value="instance('commcaresession')/session/context/username"/><setvalue event="xforms-ready" ref="/data/meta/userID" value="instance('commcaresession')/session/context/userid"/><setvalue event="xforms-ready" ref="/data/meta/instanceID" value="uuid()"/><setvalue event="xforms-ready" ref="/data/meta/appVersion" value="instance('commcaresession')/session/context/appversion"/></model>
	</h:head>
	<h:body>
		<group ref="/data/stat_disclaimer" appearance="field-list">
			<label ref="jr:itext('stat_disclaimer-label')"/>
			<trigger ref="/data/stat_disclaimer/lbl_n_consults_today" appearance="minimal">
				<label ref="jr:itext('stat_disclaimer/lbl_n_consults_today-label')"/>
			</trigger>
			<trigger ref="/data/stat_disclaimer/disclaimer_exit" appearance="minimal">
				<label ref="jr:itext('stat_disclaimer/disclaimer_exit-constraintMsg')"/>
			</trigger>
		</group>
	</h:body>
</h:html>